<%- include("../partials/header", { title: "Inbox" }) %>

<h1>ðŸ“¥ Inbox</h1>

<% if (messages.length === 0) { %>
  <p>You have no messages.</p>
<% } else { %>
  <table>
    <thead>
      <tr>
        <th>From</th>
        <th>Subject</th>
        <th>Date</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <% messages.forEach(msg => { %>
        <tr>
          <td><%= msg.sender_name %></td>
          <td><%= msg.message_subject %></td>
          <td><%= new Date(msg.message_created).toLocaleString() %></td>
          <td><%= msg.message_read ? "Read" : "Unread" %></td>
          <td>
            <a href="/messages/view/<%= msg.message_id %>">View</a>
            <form action="/messages/archive/<%= msg.message_id %>" method="POST" style="display:inline">
              <button type="submit">Archive</button>
            </form>
            <form action="/messages/delete/<%= msg.message_id %>" method="POST" style="display:inline">
              <button type="submit">Delete</button>
            </form>
          </td>
        </tr>
      <% }) %>
    </tbody>
  </table>
<% } %>

<a href="/messages/compose" class="btn">âž• Compose</a>

<%- include("../partials/footer") %>
